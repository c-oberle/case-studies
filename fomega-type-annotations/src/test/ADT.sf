module test.ADT

import extension.adt.Syntax
import extension.adt.ADT

import contextanalysis.ContextAnalysis

type Id = \X::*=>*=>*. X

data Tree (k::*) (v::*) = Nil isNil {}
                        | Leaf isLeaf {value: v}
                        | Node isNode {left: Tree k v, key: k, right: Tree k v}

data D = Foo isFoo {foo:Nat}

type X = Tree Nat Nat

val x = fold [D] (<Foo={foo=1}> as <Foo:{foo:Nat}>)
